<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/styles/csshake.min.css">
    <link rel="stylesheet" type="text/css" href="/styles/zenburn.css">
    <link rel="stylesheet" type="text/css" href="/styles/planspace.css">
    <title>The flow metaphor for matrix multiplication</title>
  </head>
  <body>
    <article>
<h1>The flow metaphor for matrix multiplication</h1>
<p class="date">Wednesday September 15, 2021</p>
<blockquote>
<p><em>“I cannot believe that anything so ugly as multiplication of
matrices is an essential part of the scheme of nature.” (Arthur
Eddington, 1936)</em></p>
</blockquote>
<p>Even <a href="https://smile.amazon.com/Linear-Algebra-Its-Applications-4th/dp/0030105676/">Strang</a> introduces matrix multiplication by saying “there is
only one possible rule, and I am not sure who discovered it. It makes
everything work.” This is not satisfying or helpful for understanding.
The flow metaphor of graphical linear algebra makes matrix
multiplication seem natural and helps provide intuition for
understanding linear algebra.</p>
<ul>
<li><a href="#diagram">A simple diagram style</a></li>
<li><a href="#mult">Matrix multiplication</a></li>
<li><a href="#directions">Aligning directions</a></li>
<li><a href="#sources">Sources</a></li>
</ul>
<hr />
<h3><a name="diagram" href="#diagram">A simple diagram style</a></h3>
<p>The inputs <em>x</em> and <em>y</em> pass from left to right along the arrow
paths—getting multiplied by <em>a</em>, <em>b</em>, <em>c</em>, and <em>d</em>, respectively—and
then adding up to outputs <em>i</em> and <em>j</em>.</p>
<p><img alt="vector - matrix multiplication" src="vec_mat_mult.png" /></p>
<p>The diagram is equivalent to the usual notation for a simple
vector-matrix multiplication.</p>
<p>\[ \begin{bmatrix} i \\ j \end{bmatrix} =
    \begin{bmatrix} a &amp; b \\ c &amp; d \end{bmatrix}
    \begin{bmatrix} x \\ y \end{bmatrix} =
    \begin{bmatrix} ax+by \\ cx+dy \end{bmatrix} \]</p>
<p>You can visualize inputs entering at the top and outputs going out the
side. For example, the <em>x</em> enters the 2-by-2 matrix over the <em>a</em>, and
then exits to the left to contribute <em>ax</em> to <em>i</em>. The <em>y</em> enters over
the <em>b</em> and exits to the left to contribute <em>by</em> to <em>i</em>.</p>
<hr />
<h3><a name="mult" href="#mult">Matrix multiplication</a></h3>
<p>To compose two matrix diagrams, follow the paths from inputs to
outputs. For example, to go from <em>x</em> to <em>u</em>, there's the <em>ae</em> path
that goes via <em>i</em>, and there's the <em>cf</em> path that goes via <em>j</em>, so the
simplified single path from <em>x</em> to <em>u</em> is <em>ae + cf</em>.</p>
<p><img alt="matrix - matrix multiplication" src="mat_mat_mult.png" /></p>
<p>This is matrix multiplication that makes sense. After the input-output
behavior <a href="#diagram">above</a> is established, there's no other way for matrix
multiplication to come out.</p>
<p>\[ \begin{bmatrix} e &amp; f \\ g &amp; h \end{bmatrix}
    \begin{bmatrix} a &amp; b \\ c &amp; d \end{bmatrix} =
    \begin{bmatrix} ae+cf &amp; be+df \\ ag+ch &amp; bg+dh \end{bmatrix} \]</p>
<p>Why do the inner dimensions need to be the same for two matrices
you're multiplying? Because you have to match up outputs from one with
inputs for the other.</p>
<p>I find this <a href="https://en.wikipedia.org/wiki/Where_Mathematics_Comes_From" title="Where Mathematics Comes From: How the Embodied Mind Brings Mathematics into Being">metaphor</a> really helpful, and I suspect it could help
people learning linear algebra for the first time as well. I think it
can be complementary with thinking about (and <a href="https://www.youtube.com/playlist?list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab" title="Essence of linear algebra, from 3Blue1Brown">visualizing</a>) vector
spaces. Exposition might proceed from introducing the idea of linear
combinations, to the diagram form, to the matrix notation, for
example.</p>
<hr />
<h3><a name="directions" href="#directions">Aligning directions</a></h3>
<p>I think it's a good thing that the diagrams make it obvious that order
matters. I'd rather have both the diagrams and matrix notation read
naturally from left to right, but I don't think everybody will change
how they write their linear algebra.</p>
<p>There's nothing special about the usual orientation. Both directions
are “on” by default. You can multiply a row vector and matrix, which
is like going right to left along the diagram for the matrix. You can
see the result isn't equivalent unless you transpose.</p>
<p>Transpose is the operation that swaps inputs with outputs For example,
\( (A B)^T = B^T A^T \). Visualize rotating two connected pieces of
pipe.</p>
<p>For a given order, sometimes it feels more natural to think about
going left to right rather than right to left. For example, in the \(
y = X \beta \) of linear regression, it feels better to me to think
of moving a row of the data matrix \( X \) through the coefficient
transformation \( \beta \), rather than thinking of the data \( X
\) as transforming the coefficients. Either way.</p>
<p>Note also that a column vector is not the same as a row vector, and
neither are the same as a vector. We probably shouldn't say a vector
<em>is</em> any particular matrix.</p>
<hr />
<h3><a name="sources" href="#sources">Sources</a></h3>
<p>I started thinking about this based on §3.2.2.4 in Spivak's <em>Category
Theory for the Sciences</em>. A complete, rigorous formulation as
Graphical Linear Algebra is nicely introduced in
<a href="https://graphicallinearalgebra.net/">Sobocinski's blog</a>. The best brief introduction I've seen is in a
<a href="https://www.youtube.com/watch?v=ptWK8ehQvyw&amp;t=3379s">presentation from Paixão</a>. (Thanks to Spivak and Sobocinski for
helpful pointers over email as well!)</p>
<p>The quote at top from <a href="https://en.wikipedia.org/wiki/Arthur_Eddington">Sir Eddington</a> about the ugliness of matrix
multiplication is from page 36 of his <em>Relativity Theory of Electrons
and Protons</em>, published in 1936 by Cambridge University Press, as
quoted in Macedo and Oliveira's <a href="https://arxiv.org/abs/1312.4818">Typing linear algebra</a>.</p>
<blockquote>
<p>“So the way we normally teach linear algebra to students is we write
down the formula for multiplying a matrix. Where does this formula
come from? I mean everyone learns it in first year, right, so we
don't question it, but it's actually very difficult to explain. I
mean I have to teach linear algebra to first-year students and, you
know, it takes them quite a bit of time to get it. And they learn
it, they get it by memorizing, you know, these kinds of algorithms
in their heads, but this is not the way we should teach maths. We
shouldn't teach maths, you know, by telling people to memorize
algorithms.” (<a href="https://www.youtube.com/watch?v=yHUp23AyF2A">Sobocinski</a>)</p>
</blockquote>
<!-- mathjax for formulas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
    </article>
    <footer>
      <hr />
<p><a name="contact"></a><form class="email_updates">
  <input type="email" name="email" placeholder="your@email.address" style="width: 49%" />
  <input type="submit" value="Get monthly updates" style="width: 49%" />
  <input type="hidden" name="_subject" value="planspace.org updates list" />
  <input type="text" name="_honey" style="display:none" />
  <input type="hidden" name="_captcha" value="false" />
</form></p>
<p><a id="back_link2" href="/">This site</a> also has <a href="/rss.xml">RSS</a>. You can connect with <a id="aaron_link2" href="/aaron/">me</a> via <a href="https://twitter.com/planarrowspace">Twitter</a>, <a href="https://www.linkedin.com/in/ajschumacher">LinkedIn</a>, <a href="https://github.com/ajschumacher">GitHub</a>, and <a href="mailto:aaron@planspace.org">email</a>.</p>

      <hr />
    </footer>

<!-- my weird stuff -->
<script src="/scripts/planspace.js"></script>

<!-- syntax highlighting -->
<script src="/scripts/highlight.pack.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-44351009-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Disqus comments -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'planspace';
  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

  </body>
</html>

<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/styles/csshake.min.css">
    <link rel="stylesheet" type="text/css" href="/styles/zenburn.css">
    <link rel="stylesheet" type="text/css" href="/styles/planspace.css">
    <script defer data-domain="planspace.org" src="https://plausible.io/js/script.js"></script>
    <title>Dot product really does give you cosine</title>
  </head>
  <body>
    <article>
<h1>Dot product really does give you cosine</h1>
<p class="date">Saturday September  4, 2021</p>
<p>The <a href="https://en.wikipedia.org/wiki/Dot_product">dot product</a> of \( A \) and \( B \) gives you the
<a href="https://en.wikipedia.org/wiki/Trigonometric_functions">cosine</a> of the angle \( \gamma \) between them, scaled by the
product of their lengths, \( a \) and \( b \) (Equation 1). Here's
a proof using the Law of Cosines.</p>
<p>\[ A \cdot B = \cos \left( \gamma \right) a b \tag{1} \]</p>
<p><center><img src="diagram.jpg" height="200px" /></center></p>
<p>Equation 1 is invoked, for example, in defining <a href="https://en.wikipedia.org/wiki/Cosine_similarity">cosine similarity</a>,
often without derivation.</p>
<p>If, in \( n \) dimensions, the <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_system">Cartesian coordinates</a> of a point
\( X \) are \( x_1, x_2, \dotso, x_n \), then the dot product \(
A \cdot B \) is the sum of element-wise products as in Equation 2.</p>
<p>\[ A \cdot B = \sum_{i=1}^n{a_i b_i} \tag{2} \]</p>
<p>The dot product is so simple, it's a little surprising a nice
trigonometric function like cosine should come out of it in arbitrary
high-dimensional spaces.</p>
<p>Notation has been chosen so as to write the <a href="https://en.wikipedia.org/wiki/Law_of_cosines">Law of Cosines</a> as
usual in Equation 3.</p>
<p>\[ c^2 = a^2 + b^2 - 2 a b \cos \left( \gamma \right) \tag{3} \]</p>
<p>The \( c^2 \) in Equation 3 is the square of the distance from \( A
\) to \( B \) and can also be written, using the
<a href="https://en.wikipedia.org/wiki/Pythagorean_theorem">Pythagorean theorem</a>, as in Equation 4.</p>
<p>\[ c^2 =
    \sum_{i=1}^k{ \left( a_i - b_i \right)^2 } =
    \sum_{i=1}^k{ a_i^2 + b_i^2 - 2 a_i b_i } =
    a^2 + b^2 - 2 \sum_{i=1}^k{ a_i b_i } \tag{4} \]</p>
<p>Equating the right hands of Equations 3 and 4, and recognizing the dot
product as in Equation 2, we've built Equation 1 from scratch. \(
\Box \)</p>
<hr />
<p>It's also possible to use two-dimensional right triangle visualization
thinking to see how dot product projects one vector onto another, with
scaling by the lengths of the vectors. 3Blue1Brown has a great
<a href="https://www.youtube.com/watch?v=LyGKycYT2v0&amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab&amp;index=10">video</a>. It's easy to connect to the usual definition of cosine.</p>
<p>Since you can always rotate your coordinate frame to get one vector
with all zero coordinates except for one, and the other vector with
all zero coordinates except for that one and one more, it's clear that
dot product should give cosine in that frame, but it isn't necessarily
obvious (to me) that everything works out in other coordinate frames.
The proof above gives me confidence that it does. (Not that I didn't
believe it before, but it's nice to have a reason.)</p>
<hr />
<p>I wasn't quite satisfied with cosine similarity via dot product for a
long time. My satisfaction now and the proof above is based quite
directly on the proof Hamming generously gives on pages 117-118 of
<a href="/20200725-art_of_doing_science_and_engineering/">The Art of Doing Science and Engineering</a>. As he says there
(italics in original):</p>
<blockquote>
<p>"I have found it very valuable in important situations to review
<em>all the basic derivations involved</em> so I have a firm feeling for
what is going on."</p>
</blockquote>
<p>He uses different (possibly better?) notation, and his figure is
certainly nicer than mine.</p>
<!-- mathjax for formulas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
    </article>
    <footer>
      <hr />
<p><a name="contact"></a><form class="email_updates">
  <input type="email" name="email" placeholder="your@email.address" style="width: 49%" />
  <input type="submit" value="Get monthly updates" style="width: 49%" />
  <input type="hidden" name="_subject" value="planspace.org updates list" />
  <input type="text" name="_honey" style="display:none" />
  <input type="hidden" name="_captcha" value="false" />
</form></p>
<p><a id="back_link2" href="/">This site</a> also has <a href="/rss.xml">RSS</a>. You can connect with <a id="aaron_link2" href="/aaron/">me</a> via <a href="https://twitter.com/planarrowspace">Twitter</a>, <a href="https://www.linkedin.com/in/ajschumacher">LinkedIn</a>, <a href="https://github.com/ajschumacher">GitHub</a>, and <a href="mailto:aaron@planspace.org">email</a>.</p>

      <hr />
    </footer>

<!-- my weird stuff -->
<script src="/scripts/planspace.js"></script>

<!-- syntax highlighting -->
<script src="/scripts/highlight.pack.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-44351009-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Disqus comments -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'planspace';
  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

  </body>
</html>

<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/styles/csshake.min.css">
    <link rel="stylesheet" type="text/css" href="/styles/zenburn.css">
    <link rel="stylesheet" type="text/css" href="/styles/planspace.css">
    <title>Deep Reinforcement Learning</title>
  </head>
  <body>
    <article>
<h1>Deep Reinforcement Learning</h1>
<p class="date">Tuesday November 14, 2017</p>
<p><em>This is a presentation given for <a href="https://www.meetup.com/Data-Science-DC/">Data Science DC</a> on <a href="https://www.meetup.com/Data-Science-DC/events/244145151">Tuesday November 14, 2017</a>.</em></p>
<ul>
<li><em><a href="deep_rl.pdf">PDF slides</a></em></li>
<li><em><a href="deep_rl.pptx">PPTX slides</a></em></li>
</ul>
<p>Further resources up front:</p>
<ul>
<li><a href="https://arxiv.org/abs/1708.05866">A Brief Survey of Deep Reinforcement Learning</a> (paper)</li>
<li>Karpathy's <a href="http://karpathy.github.io/2016/05/31/rl/">Pong from Pixels</a> (blog post)</li>
<li><a href="http://incompleteideas.net/sutton/book/the-book-2nd.html">Reinforcement Learning: An Introduction</a> (textbook)</li>
<li>David Silver's <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html">course</a> (videos and slides)</li>
<li><a href="https://sites.google.com/view/deep-rl-bootcamp/lectures">Deep Reinforcement Learning Bootcamp</a> (videos, slides, and labs)</li>
<li>OpenAI <a href="https://github.com/openai/gym">gym</a> / <a href="https://github.com/openai/baselines">baselines</a> (software)</li>
<li><a href="http://nationalgocenter.org/">National Go Center</a> (physical place)</li>
<li><a href="http://dc.hackandtell.org/">Hack and Tell</a> (fun meetup)</li>
</ul>
<p>The following goes through all the content of the talk:</p>
<hr />
<p>Aaron Schumacher</p>
<ul>
<li>planspace.org has these slides</li>
</ul>
<hr />
<p>Hi! I'm Aaron. All these slides, and a corresponding write-up (you're reading it) are on my blog (which you're on).</p>
<hr />
<p><img alt="Deep Learning Analytics" src="img/dla.png" /></p>
<hr />
<p>I work at <a href="http://www.deeplearninganalytics.com/">Deep Learning Analytics</a> (DLA). We do deep learning work for government and commercial customers. DLA is a great place to work, and one of the ways it's great is that it sends us to conferences and such things.</p>
<hr />
<p><img alt="Deep RL Bootcamp" src="img/deep_rl_bootcamp.png" /></p>
<hr />
<p>DLA sent me to the first UC Berkeley <a href="https://www.deepbootcamp.io/">Deep RL Bootcamp</a> organized by Abbeel, Duan, Chen, and Karpathy. It was a great experience and it largely inspired this talk.</p>
<p>I have a separate <a href="/20170830-berkeley_deep_rl_bootcamp/">summary write-up</a> about my experience at the bootcamp, and they've since put up all the <a href="https://sites.google.com/view/deep-rl-bootcamp/lectures">videos, slides, and labs</a>, so you can see everything that was covered there.</p>
<hr />
<p><img alt="Sutton and Barto's textbook" src="img/sutton_and_barto.jpg" /></p>
<hr />
<p>The other major source for this talk is Sutton and Barto's textbook, which I like a lot.</p>
<p>The picture shows <a href="https://mitpress.mit.edu/books/reinforcement-learning">the first edition</a>, which is not what you want. The second edition is <a href="http://incompleteideas.net/sutton/book/the-book-2nd.html">available free online</a>, and was last updated about a week ago (November 5, 2017).</p>
<p>Sutton and Barto are major figures in reinforcement learning, and they do not follow any <a href="https://en.wikipedia.org/wiki/Wikipedia:No_original_research">no original research rules</a>, making their book really fairly exciting, if you're not put off by the length (over 400 pages).</p>
<p>(The diagrams on the cover are not neural nets, but backup diagrams.)</p>
<hr />
<p>Plan</p>
<ul>
<li>applications: what<ul>
<li>theory</li>
</ul>
</li>
<li>applications: how</li>
<li>onward</li>
</ul>
<hr />
<p>The plan for today is to first mention four successful applications of reinforcement learning. Then we'll go through a core of theory. This will let us then understand pretty completely how each of those applications is achieved. Finally, we'll wrap up, looking at a few other applications and thoughts about how things are going.</p>
<hr />
<p>applications: what</p>
<hr />
<p>The applications here are all going to be games, not because reinforcement learning is only applicable to games, but because games are fun, and these examples are well known and cover a good range of techniques.</p>
<hr />
<p><img alt="backgammon" src="img/backgammon.png" /></p>
<hr />
<p>First up, backgammon.</p>
<hr />
<p><img alt="Atari Breakout" src="img/breakout.png" /></p>
<hr />
<p>Next, Atari. A lot of Atari games are well played by RL now. The ones shown (Video Pinball, Boxing, Breakout) are some of the ones that RL does the best on.</p>
<hr />
<p><img alt="tetris" src="img/tetris.png" /></p>
<hr />
<p>I'm also including Tetris, mostly because it's a chance to talk about an interesting technique.</p>
<hr />
<p><img alt="go" src="img/go.jpg" /></p>
<hr />
<p>And in the last two years, Go has been pretty much conquered by RL, so we'll talk about that.</p>
<hr />
<p>theory</p>
<hr />
<p>Let's start to build up the theory of reinforcement learning.</p>
<p>This is going to start very gradually, but I promise that by the end we'll be moving fast.</p>
<hr />
<p>Yann LeCun's cake</p>
<ul>
<li>cake: unsupervised learning</li>
<li>icing: supervised learning</li>
<li>cherry: reinforcement learning</li>
</ul>
<p><img alt="cake" src="img/cake.jpg" /></p>
<hr />
<p>Yann LeCun <a href="https://drive.google.com/file/d/0BxKBnD5y2M8NREZod0tVdW5FLTQ/view">introduced</a> this cake idea for relating three main varieties of machine learning. It's largely based on one view of how much information is used at each training step.</p>
<p>I'm going to use it to build up and relate these three kinds of learning, while introducing reinforcement learning notation.</p>
<hr />
<p>unsupervised learning</p>
<ul>
<li>\( s \)</li>
</ul>
<hr />
<p>In unsupervised learning, we have a collection of states, where each individual state can be referred to with \( s \).</p>
<p>I'm using "state" without distinguishing "state" from "observation". You could also call these "examples" or "<a href="https://en.wikipedia.org/wiki/Covariate">covariates</a>" or "data points" or whatever you like.</p>
<p>The symbol "x" is commonly used.</p>
<hr />
<p>state \( s \)</p>
<ul>
<li>numbers</li>
<li>text (as numbers)</li>
<li>image (as numbers)</li>
<li>sound (as numbers)</li>
</ul>
<hr />
<p>States can be anything as long as it can be expressed numerically. So that includes text, images, and sound. Really anything.</p>
<hr />
<p>unsupervised (?) learning</p>
<ul>
<li>given \( s \)</li>
<li>learn \( s \rightarrow \text{cluster_id} \)</li>
<li>learn \( s \rightarrow s \)</li>
</ul>
<hr />
<p>So say we have a set of a thousand images. Each image is an \( s \).</p>
<p>We want to learn something, and that tends to mean unsupervised learning starts to resemble supervised learning.</p>
<p>At two ends of a spectrum we have clustering and <a href="https://en.wikipedia.org/wiki/Autoencoder">autoencoders</a>, and all kinds of dimensionality reduction in between.</p>
<p>Unsupervised learning is sort of the <a href="https://en.wikipedia.org/wiki/Dark_matter">dark matter</a> of machine learning. Even <a href="https://www.youtube.com/watch?v=vdWPQ6iAkT4">Yann LeCun</a> says "We are missing the principles for unsupervised learning."</p>
<hr />
<p>deep unsupervised learning</p>
<ul>
<li>\( s \) with deep neural nets</li>
</ul>
<hr />
<p>Deep unsupervised learning is whenever we do unsupervised learning and somewhere there's a deep neural net.</p>
<hr />
<p>supervised learning</p>
<ul>
<li>\( s \rightarrow a \)</li>
</ul>
<hr />
<p>Up next is supervised learning. We're introducing a new entity \( a \), which I'll call an "action". It's common to call it a "label" or a "target" and to use the symbol "y". Same thing.</p>
<hr />
<p>action a</p>
<ul>
<li>numbers</li>
<li>"cat"/"dog"</li>
<li>"left"/"right"</li>
<li>17.3</li>
<li>[2.0, 11.7, 5]</li>
<li>4.2V</li>
</ul>
<hr />
<p>Whatever you call it, the action is again a numeric thing. It could be anything that \( s \) could be, but it tends to be lower-dimensional.</p>
<p>The cat/dog classifier is a popular example, and a left/right classifier is just the same, but those might feel more like actions.</p>
<hr />
<p>supervised learning</p>
<ul>
<li>given \( s, a \)</li>
<li>learn \( s \rightarrow a \)</li>
</ul>
<hr />
<p>In supervised learning you have a training set of state-action pairs, and you try to learn a function to produce the correct action based on the state alone.</p>
<p>Supervised learning can blur into imitation learning, which can be taken as a kind of reinforcement learning. For example, <a href="https://arxiv.org/abs/1604.07316">NVIDIA's end-to-end self-driving car</a> is based on learning human driving behaviors. (Sergey Levine <a href="https://www.youtube.com/watch?v=Pw1mvoOD-3A&amp;list=PLkFD6_40KJIxopmdJF_CLNqG3QuDFHQUm&amp;index=13">explains</a> in some depth.) But I'm not going to talk more about imitation learning, and supervised learning will stand alone.</p>
<p>You can learn this function with linear regression or support vector machines or whatever you like.</p>
<hr />
<p>deep supervised learning</p>
<ul>
<li>\( s \rightarrow a \) with deep neural nets</li>
</ul>
<hr />
<p>Deep supervised learning is whenever we do supervised learning and somewhere there's a deep neural net.</p>
<p>There's also semi-supervised learning, when you have some labeled data and some unlabeled data, which can connect to active learning, which has some relation to reinforcement learning, but that's all I'll say about that.</p>
<hr />
<p>reinforcement learning</p>
<ul>
<li>\(r, s \rightarrow a\)</li>
</ul>
<hr />
<p>Finally, we reach reinforcement learning.</p>
<p>We're adding a new thing \( r \), which is reward.</p>
<hr />
<p>reward \( r \)</p>
<ul>
<li>-3</li>
<li>0</li>
<li>7.4</li>
<li>1</li>
</ul>
<hr />
<p>Reward is a scalar, and we like positive rewards.</p>
<hr />
<p>optimal control / reinforcement learning</p>
<hr />
<p>I'll mention that <a href="https://en.wikipedia.org/wiki/Optimal_control">optimal control</a> is closely related to reinforcement learning. It has its own parallel notation and conventions, and I'm going to ignore all that.</p>
<hr />
<p>\( r, s \rightarrow a \)</p>
<hr />
<p>So here's the reinforcement learning setting.</p>
<p>We get a reward and a state, and the agent chooses an action.</p>
<hr />
<p>tick</p>
<hr />
<p>Then, time passes. We're using discrete time, so this is a "tick".</p>
<hr />
<p>\( r', s' \rightarrow a' \)</p>
<hr />
<p>Then we get a new reward and state, which depend on the previous state and action, and the agent chooses a new action.</p>
<hr />
<p>tick</p>
<hr />
<p>And so on.</p>
<hr />
<p><img alt="standard diagram" src="img/standard_diagram.png" /></p>
<hr />
<p>This is the standard reinforcement learning diagram, showing the agent and environment. My notation is similar.</p>
<hr />
<p>reinforcement learning</p>
<ul>
<li>"given" \( r, s, a, r', s', a', ... \)</li>
<li>learn "good" \( s \rightarrow a \)</li>
</ul>
<hr />
<p>So here's reinforcement learning.</p>
<p>"Given" is in quotes because the rewards and states that we see depend on the actions we choose.</p>
<p>"Good" is in quotes because we haven't defined "good" beyond that we like positive rewards.</p>
<hr />
<p>Question:</p>
<p>Can you formulate supervised learning as reinforcement learning?</p>
<hr />
<p>Here's a question to think about.</p>
<hr />
<p>supervised as reinforcement?</p>
<ul>
<li>reward 0 for incorrect, reward 1 for correct<ul>
<li>beyond binary classification?</li>
</ul>
</li>
<li>reward deterministic</li>
<li>next state random</li>
</ul>
<hr />
<p>You can re-cast supervised learning as reinforcement learning, but it isn't necessarily as efficient: it's better to be told what the right answer is than to just be told that you're wrong. This is one sense in which Yann LeCun means that reinforcement learning is using fewer bits of information per example.</p>
<hr />
<p>Question:</p>
<p>Why is the Sarsa algorithm called Sarsa?</p>
<hr />
<p>Here's a question that you can already figure out!</p>
<p>(Sarsa is an on-policy TD control algorithm due to Sutton, 1996.)</p>
<hr />
<p>reinforcement learning</p>
<ul>
<li>\( r, s \rightarrow a \)</li>
</ul>
<hr />
<p>Sarsa: State, Action, Reward, State, Action.</p>
<p>We'll see the closely related Q-learning algorithm in some detail later on.</p>
<hr />
<p>deep reinforcement learning</p>
<ul>
<li>\( r, s \rightarrow a \) with deep neural nets</li>
</ul>
<hr />
<p>Deep reinforcement learning is whenever we do reinforcement learning and somewhere there's a deep neural net.</p>
<p>The one twist is that in reinforcement learning, the network(s) may not be in the obvious place. We'll need to develop a few more ideas to see more places to put a neural net.</p>
<hr />
<p>Markov property</p>
<ul>
<li>\( s \) is enough</li>
</ul>
<hr />
<p>We're going to assume <a href="https://en.wikipedia.org/wiki/Markov_property">the Markov property</a>, which means that the state we observe tells us as much as we can know about what will happen next.</p>
<p>This is frequently not true, but we'll assume it anyway.</p>
<hr />
<pre><code>                   Make choices?
                   no                        yes
Completely    no   Markov chain              MDP: Markov Decision Process
observable?   yes  HMM: Hidden Markov Model  POMDP: Partially Observable MDP</code></pre>

<hr />
<p>This chart relates a bunch of Markov things, to hopefully help you orient yourself.</p>
<p>We're working with Markov Decision Processes (MDPs). Even though things are frequently not really completely observable, we'll usually just ignore that. Often this is fine (think about blackjack, for example).</p>
<p>It's often easiest to think about finite spaces, but this isn't always necessary.</p>
<p>(The chart is from <a href="http://www.pomdp.org/faq.html">POMDP.org</a>.)</p>
<hr />
<p>usual RL problem elaboration</p>
<hr />
<p>We'll introduce some more notation and a few ideas that help us work on reinforcement learning problems.</p>
<hr />
<p>policy \( \pi \)</p>
<ul>
<li>\( \pi: s \rightarrow a \)</li>
</ul>
<hr />
<p>This thing that takes a state and produces an action we'll call a "policy" \( \pi \). This effectively <em>is</em> our reinforcement learning agent, and the name of the game is figuring out how to get a good policy.</p>
<p>But how do we even know whether a policy is good?</p>
<p>(If you don't like spelling in Greek, you can imagine it's a little walker!)</p>
<hr />
<p>return</p>
<ul>
<li>\( \sum{r} \)<ul>
<li>into the future (episodic or ongoing)</li>
</ul>
</li>
</ul>
<hr />
<p>We want a policy that maximizes "return" \( \sum{r} \). Return is just the sum of all the rewards we'll get into the future. The symbol "G" is also used, but I'll keep writing the sum.</p>
<p>Reinforcement learning can consider finite-length episodes that always come to an end, or the ongoing setting in which the agent keeps on going. (You can see that there could be a problem with infinity in the ongoing setting.)</p>
<hr />
<p><img alt="gridworld" src="img/gridworld.png" /></p>
<hr />
<p>Here's a typical toy example for understanding reinforcement learning: a gridworld.</p>
<p>There are sixteen states, each uniquely identifiable to the agent.</p>
<p>There are four actions: go up, down, left, right.</p>
<p>We want the agent to learn to go from the start to the goal.</p>
<p>We'll say this is episodic, with each episode ending after the agent makes it to the goal.</p>
<p>So how do we set up the rewards?</p>
<hr />
<p><img alt="gridworld reward" src="img/gridworld_reward.png" /></p>
<hr />
<p>Here's a natural way to set up reward. You get a reward of one when you complete the task. What does the return at each state look like, then?</p>
<hr />
<p><img alt="gridworld return" src="img/gridworld_return.png" /></p>
<hr />
<p>The return, unfortunately, is just one everywhere. And this means that there isn't any reason to go directly to the goal. We have all the time in the world, so we could just as well meander randomly until we happen to hit the goal. This isn't very good.</p>
<hr />
<p>Question:</p>
<p>How do we keep our agent from dawdling?</p>
<hr />
<p>How can we set things up so that going directly to the goal position is incentivized?</p>
<p>Consider changing rewards, or changing how return is calculated, or anything else.</p>
<p>There are at least three approaches that are commonly used.</p>
<hr />
<p>negative reward at each time step</p>
<hr />
<p>If we get a negative reward at each time step, the only way to maximize return is to minimize episode length, so we're motivated to end the episode as soon as possible. This certainly makes sense for the episodic setting.</p>
<p>(It's like existing is pain; the agent is like <a href="http://rickandmorty.wikia.com/wiki/Mr._Meeseeks">Mr. Meeseeks</a>!)</p>
<hr />
<p>discounted rewards</p>
<ul>
<li>\( \sum{\gamma^tr} \)</li>
</ul>
<hr />
<p>It's very common to use a "discount factor" \( \gamma \), which might be 0.9, for example. Then a reward soon is worth more than a reward later, and again the agent is motivated to do things more directly.</p>
<hr />
<p>average rate of reward</p>
<ul>
<li>\( \frac{\sum{r}}{t} \)</li>
</ul>
<hr />
<p>Average rate of reward is also used in some settings, where it can make things more stable.</p>
<hr />
<p>value functions</p>
<ul>
<li>\( v: s \rightarrow \sum{r} \)</li>
<li>\( q: s, a \rightarrow \sum{r} \)</li>
</ul>
<hr />
<p>I already snuck in a value function when we saw green values for every state in the gridworld.</p>
<p>The state value function \( v \) tells us the return from any state, and the state-action value function \( q \) gives the return from any state-action combination. It might not yet be clear why the two are importantly different, so let's get into that.</p>
<hr />
<p>Question:</p>
<p>Does a value function specify a policy (if you want to maximize return)?</p>
<hr />
<p>Here's the relevant question to consider.</p>
<hr />
<p>trick question?</p>
<ul>
<li>\( v_\pi \)</li>
<li>\( q_\pi \)</li>
</ul>
<hr />
<p>Is it a trick question? Really, values depend on what you do, on your policy. But let's assume I just give you a value function and you trust it. Can you use it to induce a policy?</p>
<hr />
<p>value functions</p>
<ul>
<li>\( v: s \rightarrow \sum{r} \)</li>
<li>\( q: s, a \rightarrow \sum{r} \)</li>
</ul>
<hr />
<p>The state-action value function \( q \) certainly implies a policy. For whatever state we're in, we check the return for all available actions, and choose the action that's best.</p>
<p>For the state value function \( v \), we can get a policy in a similar way, but only if we know what state we'll be in after taking an action. That may or may not be true.</p>
<hr />
<p>environment dynamics</p>
<ul>
<li>\( s, a \rightarrow r', s' \)</li>
</ul>
<hr />
<p>The next state and reward depend on the previous state and action, and that's determined by the environment. We don't necessarily know what's going on inside the environment.</p>
<hr />
<p><img alt="gridworld" src="img/gridworld.png" /></p>
<hr />
<p>When you, a smart human with lots of ideas about physics, look at this picture of a gridworld, you assume that going "right" will do what you expect.</p>
<p>But in general, we don't know in advance how the environment behaves. Maybe going "right" always takes you to the upper left state, for example.</p>
<p>Sometimes you do know the environment dynamics, like with games with well-defined rules. But sometimes you don't. You could try to learn the environment dynamics with a model.</p>
<hr />
<p>model</p>
<ul>
<li>\( s, a \rightarrow r', s' \)</li>
</ul>
<hr />
<p>Reinforcement learning uses "model" to refer to a model that you learn for the environment dynamics. (Often, just the next state is predicted.)</p>
<p>This model is something that the agent has to learn, and depending on whether the agent is learning a model determines whether you're said to be doing model-based vs. model-free reinforcement learning.</p>
<p>(In adaptive control this "model learning" is called "system identification".)</p>
<hr />
<p>learning and acting</p>
<hr />
<p>Everything to this point has been elaborating the problem setup for reinforcement learning. Now we get into how we actually learn and go forth with RL.</p>
<hr />
<p>learn model of dynamics</p>
<ul>
<li>from experience</li>
<li>difficulty varies</li>
</ul>
<hr />
<p>As mentioned, you could try to learn your environment's dynamics. If you can do this well, it's great, but it may not be easy. Model-based RL is an exciting area of research.</p>
<hr />
<p>learn value function(s) with planning</p>
<ul>
<li>assuming we have the environment dynamics or a good model already</li>
</ul>
<hr />
<p>To introduce value function learning, let's consider the situation where you know nothing yet but you have the environment dynamics, so you can make decisions by looking ahead. This is a familiar thought process, conceptually.</p>
<hr />
<p><img alt="planning 0" src="img/planning0.png" /></p>
<hr />
<p>You're in state \( s_1 \) and you have to choose between \( a_1 \) and \( a_2 \).</p>
<p>Because you have the environment dynamics, you can see what would happen next.</p>
<hr />
<p><img alt="planning 1" src="img/planning1.png" /></p>
<hr />
<p>Looking one time step ahead, you can already start to evaluate your action choices by the rewards you'd get immediately. This is the state-action value view, \( q \): you're evaluating the value of the <em>actions</em> directly.</p>
<hr />
<p><img alt="planning 2" src="img/planning2.png" /></p>
<hr />
<p>Looking two time steps ahead, you can similarly start to evaluate how good the states you would get to are. This is the state value view, \( v \).</p>
<p>This example is simple and assumes states and actions never recur. We also haven't introduced a couple more wrinkles. You can think about differences between thinking in terms of \( v \) and \( q \) later, for example in the case of backgammon.</p>
<p>This kind of planning can happen continuously in the background, or it can be done on demand at decision time. The search space can get quite large.</p>
<hr />
<p>connections</p>
<ul>
<li>Dijkstra's algorithm</li>
<li>A* algorithm</li>
<li>minimax search<ul>
<li>two-player games not a problem</li>
</ul>
</li>
<li>Monte Carlo tree search</li>
</ul>
<hr />
<p>The graph structure on the previous slide might make you think of a range of algorithms that you could already be familiar with.</p>
<p>You can think of these as smart ways of exploring the possibly very large branching structures that can spring up. <a href="https://en.wikipedia.org/wiki/Monte_Carlo_tree_search">Monte Carlo tree search</a> is particularly clever, and it will appear again later.</p>
<hr />
<p><img alt="rollout diagram" src="img/rollout_diagram.png" /></p>
<hr />
<p>One way of dealing with all the possible tree paths is just to sample from it and try to make estimates on the basis of these.</p>
<hr />
<p><img alt="backgammon roll" src="img/rollout.jpg" /></p>
<hr />
<p>I thought it was interesting to learn that the term "roll-out" comes from work on backgammon, where you literally roll dice to move a game along.</p>
<hr />
<p>everything is stochastic</p>
<hr />
<p>Backgammon has randomness in the environment, from the dice, but randomness can enter all over the place.</p>
<hr />
<p><img alt="stochastic s'" src="img/stochastic_s.png" /></p>
<hr />
<p>The next state can be random.</p>
<hr />
<p><img alt="stochastic r'" src="img/stochastic_r.png" /></p>
<hr />
<p>And the next reward can be random, as in the case of <a href="https://en.wikipedia.org/wiki/Multi-armed_bandit">multi-armed bandits</a>.</p>
<hr />
<p>exploration vs. exploitation</p>
<ul>
<li>\( \epsilon \)-greedy policy<ul>
<li>usually do what looks best</li>
<li>\( \epsilon \) of the time, choose random action</li>
</ul>
</li>
</ul>
<hr />
<p>This can always be an issue in unknown environments, but especially with randomness, we encounter the issue of exploration vs. exploitation. The \( \epsilon \)-greedy approach is one well-known way to ensure that an agent keeps exploring.</p>
<hr />
<p>Question:</p>
<p>How does randomness affect \( \pi \), \( v \), and \( q \)?</p>
<ul>
<li>\( \pi: s \rightarrow a \)</li>
<li>\( v: s \rightarrow \sum{r} \)</li>
<li>\( q: s, a \rightarrow \sum{r} \)</li>
</ul>
<hr />
<p>Now acknowledging that there's randomness all over the place, I can show another way that my notation is shorthand.</p>
<hr />
<p>Question:</p>
<p>How does randomness affect \( \pi \), \( v \), and \( q \)?</p>
<ul>
<li>\( \pi: \mathbb{P}(a|s) \)</li>
<li>\( v: s \rightarrow \mathbb{E} \sum{r} \)</li>
<li>\( q: s, a \rightarrow \mathbb{E} \sum{r} \)</li>
</ul>
<hr />
<p>I haven't been hiding too much. A policy is a probability distribution over possible actions, and value functions give expectations. No problem.</p>
<hr />
<p>Monte Carlo returns</p>
<ul>
<li>\( v(s) = ? \)</li>
<li>keep track and average</li>
<li>like "planning" from experienced "roll-outs"</li>
</ul>
<hr />
<p>Here's our first pass at a model-free learning algorithm. We interact with the environment, and use our experiences in the past just like model-based roll-outs.</p>
<hr />
<p>non-stationarity</p>
<ul>
<li>\( v(s) \) changes over time!</li>
</ul>
<hr />
<p>The environment may change, and we want our methods to be able to deal with this.</p>
<hr />
<p>moving average</p>
<ul>
<li>new mean = old mean + \( \alpha \)(new sample - old mean)</li>
</ul>
<hr />
<p>This kind of moving average is used all over the place.</p>
<p>The parameter \( \alpha \) is a learning rate, and the whole thing can be seen to be a case of stochastic gradient descent, which is a nice early connection to neural nets which start turning up.</p>
<p>(Sutton and Barto use \( \alpha \) for learning rate, not the otherwise popular \( \eta \). This is a sensible choice for them especially since they sometimes have multiple learning rates in the same algorithm, and the second learning rate can then be \( \beta \).)</p>
<hr />
<p><img alt="MDP diagram" src="img/mdp_diagram.png" /></p>
<hr />
<p>We can think about this question, which is not a trick: the difference is \( r' \).</p>
<hr />
<p>Bellman equation</p>
<ul>
<li>\( v(s) = r' + v(s') \)</li>
</ul>
<hr />
<p>That relation gives rise to a bunch of Bellman equations, which are quite useful.</p>
<p><a href="https://en.wikipedia.org/wiki/Richard_E._Bellman">Bellman</a> came up with a couple neat things. <a href="https://en.wikipedia.org/wiki/Dynamic_programming">Dynamic programming</a> (despite being <a href="http://arcanesentiment.blogspot.com/2010/04/why-dynamic-programming.html">poorly named</a>) is great for lots of problems, including those involving Bellman equations.</p>
<p>Bellman also introduced the phrase "<a href="https://en.wikipedia.org/wiki/Curse_of_dimensionality">curse of dimensionality</a>".</p>
<hr />
<p>temporal difference (TD)</p>
<hr />
<p>Bellman equations give rise to temporal difference (TD) learning (Sutton, 1988).</p>
<p>It's sometimes described as "bootstrap" learning.</p>
<hr />
<p>Q-learning</p>
<ul>
<li>\( \text{new } q(s, a) = q(s, a) + \alpha (r' + \gamma \max_{a} q(s', a) - q(s, a)) \)</li>
</ul>
<hr />
<p>Q-learning is a temporal difference method that combines a lot of the things we've just seen.</p>
<p>You can see in the equation that Sarsa is closely related.</p>
<hr />
<p>on-policy / off-policy</p>
<hr />
<p>Reinforcement learning differentiates between on-policy and off-policy learning. On-policy learning is when you're learning about the policy that you're currently following, and it's generally easier than off-policy learning.</p>
<p>Importance sampling is one way to achieve off-policy learning.</p>
<p>Q-learning is off-policy, which is nice. You can look at the equation and see why.</p>
<hr />
<p>estimate \( v \), \( q \)</p>
<ul>
<li>with a deep neural network</li>
</ul>
<hr />
<p>We've sort of implicitly been doing what's called tabular learning, where each state or state-action has its own estimated return. But we can plug in any kind of supervised learning algorithm, including deep learning. We'll see this in applications.</p>
<hr />
<p>back to the \( \pi \)</p>
<ul>
<li>parameterize \( \pi \) directly</li>
<li>update based on how well it works</li>
<li>REINFORCE<ul>
<li>REward Increment = Nonnegative Factor times Offset Reinforcement times Characteristic Eligibility</li>
</ul>
</li>
</ul>
<hr />
<p>Stepping back from value functions, we can work with a parameterized policy directly.</p>
<p>REINFORCE is not necessarily a great acronym.</p>
<hr />
<p>policy gradient</p>
<ul>
<li>\( \nabla \log (\pi(a|s))\)</li>
</ul>
<hr />
<p>This is the gradient that you use.</p>
<p>You may see the connection to score functions and the so-called <a href="http://blog.shakirm.com/2015/11/machine-learning-trick-of-the-day-5-log-derivative-trick/">log-derivative trick</a>, but we can interpret without all that.</p>
<p>If an action contributes to high return, you can encourage it, and if it contributes to low return, you can discourage it.</p>
<hr />
<p>actor-critic</p>
<ul>
<li>\( \pi \) is the actor</li>
<li>\( v \) is the critic</li>
<li>train \( \pi \) by policy gradient to encourage actions that work out better than \( v \) expected</li>
</ul>
<hr />
<p>Actor-critic algorithms combine policy gradient and value function methods to reduce variance, and are pretty popular.</p>
<hr />
<p>applications: how</p>
<hr />
<p>We now know enough to understand a lot of the details of big reinforcement learning applications!</p>
<hr />
<p>TD-gammon (1992)</p>
<ul>
<li>\( s \) is custom features</li>
<li>\( v \) with shallow neural net</li>
<li>\( r \) is 1 for a win, 0 otherwise</li>
<li>\( TD(\lambda) \)<ul>
<li>eligibility traces</li>
</ul>
</li>
<li>self play</li>
<li>shallow forward search</li>
</ul>
<hr />
<p>Backgammon was dealt with pretty completely about 25 years ago already.</p>
<p>We know what state the board will be in after any move, and the state of the board is what matters, so it makes sense to use a state value function \( v \) here.</p>
<hr />
<p>DQN (2015)</p>
<ul>
<li>\( s \) is four frames of video</li>
<li>\( v \) with deep convolutional neural net</li>
<li>\( r \) is 1 if score increases, -1 if decreases, 0 otherwise</li>
<li>Q-learning<ul>
<li>usually-frozen target network</li>
<li>clipping update size, etc.</li>
</ul>
</li>
<li>\( \epsilon \)-greedy</li>
<li>experience replay</li>
</ul>
<hr />
<p>Deep Q-Networks (DQN) is a well-known algorithm that works well for many Atari games. See:</p>
<ul>
<li><a href="https://arxiv.org/abs/1312.5602">Playing Atari with Deep Reinforcement Learning</a> (2013)</li>
<li><a href="https://deepmind.com/research/dqn/">Human-level control through Deep Reinforcement Learning</a> (2015)</li>
</ul>
<hr />
<p>evolution (2006)</p>
<ul>
<li>\( s \) is custom features</li>
<li>\( \pi \) has a simple parameterization</li>
<li>evaluate by final score</li>
<li>cross-entropy method</li>
</ul>
<hr />
<p>Surprise! Tetris is well-solved by evolutionary methods, which I didn't mention at all. These methods are sneaky that way. They can work better than you'd think. See:</p>
<ul>
<li><a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.81.6579&amp;rep=rep1&amp;type=pdf">Learning Tetris Using the Noisy Cross-Entropy Method</a> (2006)</li>
<li><a href="https://blog.openai.com/evolution-strategies/">Evolution Strategies as a Scalable Alternative to Reinforcement Learning</a></li>
</ul>
<hr />
<p>AlphaGo (2016)</p>
<ul>
<li>\( s \) is custom features over geometry<ul>
<li>big and small variants</li>
</ul>
</li>
<li>\( \pi_{SL} \) with deep convolutional neural net, supervised training</li>
<li>\( \pi_{rollout} \) with smaller convolutional neural net, supervised training</li>
<li>\( r \) is 1 for a win, -1 for a loss, 0 otherwise</li>
<li>\( \pi_{RL} \) is \( \pi_{SL} \) refined with policy gradient peer-play reinforcement learning</li>
<li>\( v \) with deep convolutional neural net, trained based on \( \pi_{RL} \) games</li>
<li>asynchronous policy and value Monte Carlo tree search<ul>
<li>expand tree with \( \pi_{SL} \)</li>
<li>evaluate positions with blend of \( v \) and \( \pi_{rollout} \) rollouts</li>
</ul>
</li>
</ul>
<hr />
<p>AlphaGo surprised a lot of people by reaching super-human levels of Go play. It was a bit complicated. See:</p>
<ul>
<li><a href="https://storage.googleapis.com/deepmind-media/alphago/AlphaGoNaturePaper.pdf">Mastering the game of Go with deep neural networks and tree search</a></li>
</ul>
<hr />
<p>AlphaGo Zero (2017)</p>
<ul>
<li>\( s \) is simple features over time and geometry</li>
<li>\( \pi, v \) with deep residual convolutional neural net</li>
<li>\( r \) is 1 for a win, -1 for a loss, 0 otherwise</li>
<li>Monte Carlo tree search for self-play training and play</li>
</ul>
<hr />
<p>AlphaGo Zero improved on AlphaGo in performance and by requiring no human training data. It reaches incredibly good performance with only its self-play learning method. See:</p>
<ul>
<li><a href="https://www.nature.com/articles/nature24270.epdf?author_access_token=VJXbVjaSHxFoctQQ4p2k4tRgN0jAjWel9jnR3ZoTv0PVW4gB86EEpGqTRDtpIz-2rmo8-KG06gqVobU5NSCFeHILHcVFUeMsbvwS-lxjqQGg98faovwjxeTUgZAUMnRQ">Mastering the game of Go without human knowledge</a><ul>
<li>Interesting quote on reach/limitations: "Our approach is most directly applicable to Zero-sum games of perfect information."</li>
</ul>
</li>
</ul>
<p>(AlphaGo Zero can only play legal moves, but stupid moves (like filling eyes) aren't forbidden, so it is less constrained than the original AlphaGo.)</p>
<hr />
<p>onward</p>
<hr />
<p>Let's look at some more applications to paint out more of the area that reinforcement learning can influence.</p>
<hr />
<p>Neural Architecture Search (NAS)</p>
<hr />
<p>Neural Architecture Search (NAS) uses policy gradient where the actions design a neural net. The reward is validation set performance. See:</p>
<ul>
<li><a href="https://research.googleblog.com/2017/11/automl-for-large-scale-image.html">AutoML for large scale image classification and object detection</a></li>
<li><a href="https://arxiv.org/abs/1707.07012">Learning Transferable Architectures for Scalable Image Recognition</a></li>
<li><a href="https://arxiv.org/abs/1611.01578">Neural Architecture Search with Reinforcement Learning</a></li>
</ul>
<hr />
<p><img alt="Amazon Echo" src="img/echo.jpg" /></p>
<hr />
<p>A lot of people are interested in natural language processing. A lot of chatbots are still big nests of <code>if</code> statements, but there is interest in using RL for language. See:</p>
<ul>
<li><a href="https://arxiv.org/abs/1709.02349">A Deep Reinforcement Learning Chatbot</a><ul>
<li><a href="https://developer.amazon.com/alexaprize">Amazon Alexa Prize</a></li>
</ul>
</li>
<li><a href="https://arxiv.org/abs/1703.04908">Emergence of Grounded Compositional Language in Multi-Agent Populations</a></li>
</ul>
<p>(In particular in the multi-agent setting, there might be some connection to <a href="https://en.wikipedia.org/wiki/Evolutionary_game_theory">evolutionary game theory</a> and the work of <a href="https://en.wikipedia.org/wiki/Peyton_Young">Peyton Young</a>.)</p>
<hr />
<p><img alt="robot" src="img/robot.jpg" /></p>
<hr />
<p>Lots of people think using RL for robot control is pretty neat.</p>
<p>(left to right: Chelsea Finn, Pieter Abbeel, <a href="http://www.willowgarage.com/pages/pr2/overview">PR2</a>, Trevor Darrell, Sergey Levine)</p>
<p>Pieter Abbeel, Peter Chen, Rocky Duan, and Tianhao Zhang <a href="https://nyti.ms/2hLYbGQ">founded Embodied Intelligence</a> to work on robot stuff, it seems.</p>
<hr />
<p>self-driving cars</p>
<ul>
<li>interest</li>
<li>results?</li>
</ul>
<hr />
<p>People seem to want to use RL for self-driving cars.</p>
<hr />
<p><img alt="OpenAI DotA 2" src="img/openai_dota2.jpg" /></p>
<hr />
<p>OpenAI has <a href="https://blog.openai.com/dota-2/">beaten</a> top human players in one-on-one DotA 2. This is pretty neat. They haven't released details of their methods as they say they're working on the full five-on-five game. We'll see!</p>
<hr />
<p>conclusion</p>
<hr />
<p>Wrapping up!</p>
<hr />
<p><img alt="bootcamp diagram" src="img/annotated.jpg" /></p>
<hr />
<p>There are <a href="/20170830-berkeley_deep_rl_bootcamp/">a lot of RL algorithms</a> with horrible acronyms.</p>
<hr />
<p>reinforcement learning</p>
<ul>
<li>\( r,s \rightarrow a \)</li>
<li>\( \pi: s \rightarrow a\)</li>
<li>\( v: s \rightarrow \sum{r} \)</li>
<li>\( q: s,a \rightarrow \sum{r} \)</li>
</ul>
<hr />
<p>But the core ideas are pretty concise, and lots of work in the field can be quickly understood to a first approximation by relating it back to these core ideas.</p>
<hr />
<p>network architectures for deep RL</p>
<ul>
<li>feature engineering can still matter</li>
<li>if using pixels<ul>
<li>often simpler than state-of-the-art for supervised</li>
<li>don't pool away location information if you need it</li>
</ul>
</li>
<li>consider using multiple/auxiliary outputs</li>
<li>consider phrasing regression as classification</li>
<li>room for big advancements</li>
</ul>
<hr />
<p>Lots of exciting developments in RL are coming from the use of deep neural nets, and I wanted to say a few things specific to doing these applications of deep learning.</p>
<hr />
<p>the lure and limits of RL</p>
<ul>
<li>seems like AI (?)</li>
<li>needs so much data</li>
</ul>
<hr />
<p>There's progress in RL now. The limits of that progress are not yet known.</p>
<p>One hot take <a href="https://twitter.com/dennybritz/status/925028640001105920">from Denny Britz</a>: "Ironically, the major advances in RL over the past few years all boil down to making RL look less like RL and more like supervised learning."</p>
<hr />
<p>Question</p>
<ul>
<li>Should you use reinforcement learning?</li>
</ul>
<hr />
<p>It's for you to decide!</p>
<hr />
<p>Thank you!</p>
<hr />
<p>Thank you for coming!</p>
<p>Thanks again to <a href="https://www.deeplearninganalytics.com/">DLA</a> for supporting me in learning more about reinforcement learning, and in being the audience for the earliest version of this talk, providing lots of valuable feedback.</p>
<p>Thanks to the <a href="https://www.meetup.com/DC-Deep-Learning-Working-Group/">DC Deep Learning Working Group</a> for working through the second iteration of this talk with me, providing even more good feedback.</p>
<p>Thanks to <a href="https://twitter.com/EricHaengel">Eric Haengel</a> for help with Go and in thinking about the <a href="https://www.nature.com/articles/nature24270.epdf?author_access_token=VJXbVjaSHxFoctQQ4p2k4tRgN0jAjWel9jnR3ZoTv0PVW4gB86EEpGqTRDtpIz-2rmo8-KG06gqVobU5NSCFeHILHcVFUeMsbvwS-lxjqQGg98faovwjxeTUgZAUMnRQ">AlphaGo Zero paper</a>.</p>
<hr />
<p>further resources</p>
<hr />
<ul>
<li><a href="https://arxiv.org/abs/1708.05866">A Brief Survey of Deep Reinforcement Learning</a> (paper)</li>
<li>Karpathy's <a href="http://karpathy.github.io/2016/05/31/rl/">Pong from Pixels</a> (blog post)</li>
<li><a href="http://incompleteideas.net/sutton/book/the-book-2nd.html">Reinforcement Learning: An Introduction</a> (textbook)</li>
<li>David Silver's <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html">course</a> (videos and slides)</li>
<li><a href="https://sites.google.com/view/deep-rl-bootcamp/lectures">Deep Reinforcement Learning Bootcamp</a> (videos, slides, and labs)</li>
<li>OpenAI <a href="https://github.com/openai/gym">gym</a> / <a href="https://github.com/openai/baselines">baselines</a> (software)</li>
<li><a href="http://nationalgocenter.org/">National Go Center</a> (physical place)</li>
<li><a href="http://dc.hackandtell.org/">Hack and Tell</a> (fun meetup)</li>
</ul>
<p>Here are my top resources for learning more about deep reinforcement
learning (and having a little fun).</p>
<p>The content of <a href="https://arxiv.org/abs/1708.05866">A Brief Survey of Deep Reinforcement Learning</a> is similar to this talk. It does a quick intro to a lot of deep reinforcement learning.</p>
<p>Karpathy's <a href="http://karpathy.github.io/2016/05/31/rl/">Pong from Pixels</a> is a readable introduction as well, focused on policy gradient, with readable code.</p>
<p>If you can afford the time, I recommend all of Sutton and Barto's <a href="http://incompleteideas.net/sutton/book/the-book-2nd.html">Reinforcement Learning: An Introduction</a>. The authors are two major reinforcement learning pioneers, to the extent that they sometimes introduce new concepts in the pages of their textbook.</p>
<p>David Silver's <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html">course</a> is quite good. It largely follows Sutton and Barto's text, and also references Csaba Szepesvári's <a href="https://sites.ualberta.ca/~szepesva/papers/RLAlgsInMDPs.pdf">Algorithms for Reinforcement Learning</a>.</p>
<p>The <a href="https://sites.google.com/view/deep-rl-bootcamp/lectures">Deep Reinforcement Learning Bootcamp</a> that inspired this talk has lots of materials online, so you can get the full treatment if you like!</p>
<p>If you want to get into code, <a href="https://openai.com/">OpenAI</a>'s <a href="https://github.com/openai/gym">gym</a> and <a href="https://github.com/openai/baselines">baselines</a> could be nice places to get started.</p>
<p>If you want to have fun, you can play Go with humans at the <a href="http://nationalgocenter.org/">National Go Center</a>, and I always recommend the <a href="http://dc.hackandtell.org/">Hack and Tell</a> meetup for a good time nerding out with people over a range of fun projects.</p>
<p>Juergen Schmidhuber's <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.81.6579&amp;rep=rep1&amp;type=pdf">Deep Learning in Neural Networks: An Overview</a> didn't make my top list, but it has an interesting section specific to using LSTMs in RL.</p>
<!-- mathjax for formulas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
    <script src="/scripts/konami.js"></script>
    <script type="text/javascript">
      var easter_egg = new Konami('big.html');
    </script>
    </article>
    <footer>
      <hr />
<p><a name="contact"></a><form class="email_updates">
  <input type="email" name="email" placeholder="your@email.address" style="width: 49%" />
  <input type="submit" value="Get email updates" style="width: 49%" />
  <input type="hidden" name="_subject" value="planspace.org updates list" />
  <input type="text" name="_honey" style="display:none" />
  <input type="hidden" name="_captcha" value="false" />
</form></p>
<p><a id="back_link2" href="/">This site</a> also has <a href="/rss.xml">RSS</a>. You can connect with <a id="aaron_link2" href="/aaron/">me</a> via <a href="https://twitter.com/planarrowspace">Twitter</a>, <a href="https://www.linkedin.com/in/ajschumacher">LinkedIn</a>, <a href="https://github.com/ajschumacher">GitHub</a>, and <a href="mailto:aaron@planspace.org">email</a>.</p>

      <hr />
    </footer>

<!-- my weird stuff -->
<script src="/scripts/planspace.js"></script>

<!-- syntax highlighting -->
<script src="/scripts/highlight.pack.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-44351009-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Disqus comments -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'planspace';
  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

  </body>
</html>
